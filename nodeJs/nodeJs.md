# Node.js 学习第一天

## Node.js 简介

V8引擎用于Chrome浏览器的JS解释部分，搬到了服务器上
　　Node.js运行在Javascript引擎上，不用建设在任何服务器软件之上。
　　Node.js自身哲学，花最小的硬件成本，追求更高的并发，更高的处理性能。

### Node.js 特性

解决服务器高性能瓶颈的三个特点

* 单线程
  * Node.js不为每个客户连接创建一个新的线程，仅仅使用一个线程。当有用户连接了，就触发一个内部事件，通过非阻塞I/O、事件驱动机制，让Node.js程序宏观上并行。好处还有操作系统完全不再有线程创建、销毁的时间开销。坏处就是一个用户造成了线程的崩溃，整个服务就崩溃了。
* 非阻塞I/O
  * 在执行访问数据库的代码之后，将立即转而执行后面的代码，把数据库返回结果的处理代码放在回调函数中，从而提高程序的执行效率。
  　　当某个I/O执行完毕时，将以事件的形式通知执行I/O操作的线程，线程执行这个事件的回调函数。为了处理异步I/O，线程必须有事件循环，不断检查有没有未处理的事件，依次予以处理。
* 事件驱动
  * 在Node中，客户端请求建立连接，提交数据等行为，会触发相应的事件。在Node中，在一个时刻，只能执行一个事件回调函数，但是在执行一个事件回调函数的中途，可以转而处理其他事件（比如，又有新用户连接了），然后返回继续执行原事件的回调函数，这种处理机制，称为“事件环机制”（事件有优先级）
  　　Node.js底层是C++（V8也是C++）。底层代码中，近半数都用于事件队列、回调函数队列的构建。用事件驱动来完成服务器的任务调度。

### Node.js适合开发什么？

Node.js善于I/O，不善于计算，因为Node.js最擅长的就是任务调度，如果你的业务有很多的CPU计算，就相当于阻塞了单线程，就不适合Node开发。
当应用程序需要处理大量并发的I/O，而在向客户端发出响应之前，应用程序内部并不需要进行非常复杂的处理的时候，Node.js非常适合。Node.js也非常适合与web socket配合，开发长连接的实时交互应用程序。
适合：

* 用户表单收集
* 考试系统
* 聊天室
* 图文直播
* 提供JSON的API（为前台angular使用）

Node.js无法挑战老牌3P

## Node.js环境

### CommonJS (02)

* 每个文件是一个模块，有自己的作用域
* 在模块内部module变量代表模块本身
* module.exports属性代表模块对外接口

### require规则 (03)

* /表示绝对路径，./表示相对于当前文件的
* 支持js、json、node拓展名,不写依次尝试
* 不写路径则认为是build-in模块或者各级node_modules内的第三方模块

### require特性

* module被加载的时候执行，加载后缓存 (04)
* 一旦出现某个模块被循环加载，就只输出已执行的部分,还未执行的部分不会输出 (05)

### global(全局变量) (09)

* CommonJS
* Buffer、process、console
* timer

#### process(进程)

* 启动变量相关：（10）
  * argv
  * argv0
  * execArgv
  * execPath
* 运行环境 （11）
  * env
* 当前执行路径 （12）
  * cwd
* timer （13）
  * setTimeout （下个队列和当前队列中间）
  * setImmediate（延迟到下个队列队首）
  * nextTick(延迟至当前队列最后一个)

### 调试 (14)

* Inspector
* VS Code